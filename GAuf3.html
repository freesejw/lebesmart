<!DOCTYPE html>
<html>
<head>

<style>

#wrapper {
  width:420px;
  height:650px;
  background-color:#FFEFDB;
  padding: 10px;
  border: 1px solid blue;
  margin: 5px;
  position:relative;
}

#bringTitel{
    position: absolute;
    left:80px;
    top:5px;
    color: #0000FF;
    font-size: 25px;
    font-weight: bold;
    line-height: 1.5em;

}
#wrtabelle1 {
position:absolute;
top:85px;
left:80px;
border-collapse:collapse;
border:1px solid #7f7f7f;

}



td {
border:1px solid #0090E0;
width:50px;
height:50px;
text-align:center;
font-size: 24px;
}

#myLevelProgress {
  position:absolute;
  left:10px;
  top:600px;
  width: 395px;
  height: 30px;
  background-color: #ddd;
  border:1px solid #0090E0;
}

      #myLevelBar { width: 0%; height: 100%;background-color:#0090E0;}
      #levelLabel {text-align: center; line-height: 30px; color: white;}

#myTimeProgress {
  position:absolute;
  left:10px;
  top:550px;
  width: 395px;
  height: 30px;
  background-color: #ddd;
  border:1px solid #0090E0;
  }

        #myTimeBar {width: 0%;height: 100%; background-color: #FF0000;}
        #myTimeLabel { text-align: center;line-height: 30px;color: white;}

#TimeLabel {
    text-align: center; /*  */
    line-height: 30px; /*  */
    color: blue;
    padding-left:220px;
}
#LevelLabel {
    text-align: center;
    line-height: 30px;
    color: blue;
    padding-left:220px;
}
p{
position:absolute;
color: red;
font-size: 20px;
 font-weight: bold;
 line-height: 1.5em;
 left:10px;
  top:430px;
}

#btnnr1 {
position:absolute;
    top: 480px;
    left:80px;
    background-color: #00AFFF; /* Green */
    border: 1 solid #0020FF;
    color: white;
    padding: 2px 2px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
}

#btnnr2 {
position:absolute;
    top: 480px;
    left:220px;
    background-color: #00AFFF; /* Green */
    border: 1 solid #0020FF;
    color: white;
    padding: 2px 2px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
}

.btn-group .button {
float:left;
margin-top:380px;
    background-color: #00AFFF;
    border: none;
    color: white;
     padding: 2px 2px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    cursor: pointer;
    width:40px;
    height:40px;

}

.btn-group .button:hover {
    background-color: red;
}
.button{
  border: 1 solid black;
}
</style>
</head>
<body onLoad="window.firstStart(7,7)">

<div id="wrapper">

<p id="bringTitel">Arbeitsspeicher &Uuml;bung 3</p>

<table  id="wrtabelle1"> </table>
<input type="button" class = "button1" id="btnnr1" value="Start (Level 1)" onclick="secondStart(anzahlZeilen,anzahlSpalten)" />
<input type="button" class = "button1" id="btnnr2" value="N&auml;chstes Level" onclick="nextLevel()" />
<div id="myLevelProgress">
  <div id="myLevelBar">
    <div id="LevelLabel">Level</div>
  </div>
</div>

<div id="myTimeProgress">
  <div id="myTimeBar">
    <div id="TimeLabel">Zeit</div>
  </div>
</div>

<br>
<p id="suchZahl"></p>


<div class ="btn-group">
  <button class="button" id="btn0" onclick="giveNumber(0)">0</button>
  <button class="button" id="btn1" onclick="giveNumber(1)">1</button>
  <button class="button" id="btn2" onclick="giveNumber(2)">2</button>
  <button class="button" id="btn3" onclick="giveNumber(3)">3</button>
  <button class="button" id="btn4" onclick="giveNumber(4)">4</button>
  <button class="button" id="btn5" onclick="giveNumber(5)">5</button>
  <button class="button" id="btn6" onclick="giveNumber(6)">6</button>
  <button class="button" id="btn7" onclick="giveNumber(7)">7</button>
  <button class="button" id="btn8" onclick="giveNumber(8)">8</button>
  <button class="button" id="btn9" onclick="giveNumber(9)">9</button>
</div>
</div>

<script>

    var anzahlZeilen=5;
    var anzahlSpalten=5;
    var anzahlZahlenStart=3;
    var StopSofort=false;
    var progressValue=0;
    var maxValueStart=-1;
    var counter=0;
    var ausgabeArray=new Array();
    var ausgabeZahl="";
    var schalter=false;
    var indexZeileVorgabe= [];
    var indexSpalteVorgabe= [];
    var timeForFind= false;
    var anzahlZahlen;
    var doppelttrue=false;
    var compareNumber;
    var freeClickButton=true;
    var wrongNumber="false";
    var actualButton;


        function start(row, col)

          {
            maxValue=maxValueStart;
            node = document.getElementById("wrtabelle1");
            node.appendChild(createTable(row, col, "tabelle1"), node);
          }


        function firstStart(z,s)
       //Startet bei Aufruf des Programms
             {
                 start(anzahlZeilen,anzahlSpalten);
                 document.getElementById("btnnr2").disabled = true;

             }

        function secondStart(z,s)
          //Startet mit dem Button "Start mit Level  1 "
          //

          {
          document.getElementById("btnnr2").disabled = false;
          document.getElementById("btnnr1").disabled = true;
             wrongNumber=false;
             tabelle1.parentNode.removeChild(tabelle1);
             maxValueStart=9;
             start(anzahlZeilen,anzahlSpalten);
             counter=0;
             StopSofort=false;
             anzahlZahlen=anzahlZahlenStart;
             VorgabeZahlErmitteln(anzahlZeilen,anzahlSpalten);
             document.getElementById("myLevelBar").style.width="0%";

          }




      function nextLevel()
      {
          //Entfernt die bestehende Tabelle und ersetzt
          // sie durch eine neue Tabelle mit neuen Zahlen
               document.getElementById("suchZahl").innerHTML =" ";
               document.getElementById("btnnr2").disabled = false;
               document.getElementById("btnnr1").disabled = true;


                tabelle1.parentNode.removeChild(tabelle1);

                maxValueStart=9;
                wrongNumber=false;
                start(anzahlZeilen,anzahlSpalten);
                 //changeCellSize(anzahlZeilen,anzahlSpalten);

                counter=0;
                StopSofort=false;
                VorgabeZahlErmitteln(anzahlZeilen,anzahlSpalten);


          }


      function createTable(row, col, id)
      {
          var myTable = document.createElement("table");
          var mytablebody = document.createElement("tbody");

          for (var j = 0; j < row; j++)
          {
              mycurrent_row = document.createElement("tr");
              for (var i = 0; i < col; i++)
               {
                  mycurrent_cell = document.createElement("td");
                  mycurrent_cell.addEventListener("click", function (iii, jjj)
                   {
                    //////////////////////////////////////////////////////////////////////////////////////

                      return function ()
                      {
                           pruef(jjj,iii,counter);
                           document.getElementById('btn' +actualButton).style.backgroundColor ="#00A0FF";

                           if (StopSofort==true)
                                {

                                   myTable.setAttribute("data-locked", "true");
                                    progressValue=0;
                                    this.style.backgroundColor = "red";
                                    if (wrongNumber==true)
                                    {
                                     document.getElementById("suchZahl").innerHTML ="Falsche Zahl. Beginn wieder mit Start";
                                    // document.write(ausgabeArray);
                                    }
                                    else
                                    {

                                    document.getElementById("suchZahl").innerHTML ="Falsches Feld. Beginn wieder mit Start";
                                    }
                                    document.getElementById("btnnr2").disabled = true;
                                    document.getElementById("btnnr1").disabled = false;
                                }


                          if (!myTable.getAttribute("data-locked"))

                             {this.style.backgroundColor = "yellow";
                                ausgabeArray
                               this.innerHTML=actualButton;

                                if (anzahlZahlen<= counter)
                                 {
                                    myTable.setAttribute("data-locked", "true");
                                    document.getElementById("suchZahl").innerHTML ="Level geschafft, auf zum nächsten Level";
                                    levelMove();
                                    anzahlZahlen = anzahlZahlen +1;

                                     document.getElementById("btnnr2").disabled = false;
                                     document.getElementById("btnnr1").disabled = true;
                                 }

                                 if (progressValue >= 100)

                                   {
                                    document.getElementById("suchZahl").innerHTML =" Glückwunsch, alle Level erfolgreich geschafft!" ;
                                    document.getElementById("suchZahl").style.color = "blue";
                                    document.getElementById("suchZahl").style.fontSize = "large";
                                    document.getElementById("btnnr2").disabled = true;
                                    document.getElementById("btnnr1").disabled = false;
                                   }
                            }
                          }
                       ////////////////////////////////////////////////////////////////////////////////////////////////
                    }
                  (i, j));

                  currenttext = document.createTextNode(random(maxValue));
                  mycurrent_cell.appendChild(currenttext);
                  mycurrent_row.appendChild(mycurrent_cell);
              }

              mytablebody.appendChild(mycurrent_row);
          }

          myTable.appendChild(mytablebody);
          myTable.setAttribute("ID", id);
          return myTable;
      }





     function pruef(z,s,c){

       // z Zeilenposition der geklickten Zahl
       // s Spaltenposition der geklickten Zahl
       // Anzahl der Clicks insgesamt(Länge der Zahl)
       // greift auf das Array vorgabe aus der Funktion VorgabeZahlErmitteln zu
       // in dem ARRay vorgabe befinden sich die Länge der Zahl,der Zeilenindex und die Spaltenindizes.

        schalter=false;

        var zeileAusClick = z;
        var spalteAusClick = s;

        for (var i = 0;i<=anzahlZahlen -1 ;i++)
            {

             if ((indexZeileVorgabe[i]==zeileAusClick) && (indexSpalteVorgabe[i]==spalteAusClick))
                  {

                      if (   ausgabeArray[i]==actualButton)
                       {
                         schalter = true;
                         StopSofort=false;
                        }
                        else
                        {
                        wrongNumber=true;
                        }
                  }
             }

            if (schalter==false)
               {
               StopSofort=true;
               }

          if (StopSofort==false)
          {counter++;}

          return StopSofort;

        }


     function VorgabeZahlErmitteln(z,s){

     // Diese Funktion ermittelt die Zahl die vorgegeben wird und die wieder durch clicken bestätigt werden muss
     //
     // in dem Array vorgabe befinden sich die Länge der Zahl,der Zeilenindex und die Spaltenindizes.
     // Dieses Array wird an die Funktion pruef übergeben.
     // s:  Anzahl spalten
     // z : Anzahl der Zeilen

          for (var i = 0; i <= anzahlZahlen-1; i++)

          {
              indexZeileVorgabe[i]=random(z-1);
              indexSpalteVorgabe[i]=random(s-1);
              var zeile= indexZeileVorgabe[i]
              var spalte= indexSpalteVorgabe[i];
             ausgabeArray[i]=document.getElementById('tabelle1').rows[zeile].cells[spalte].innerHTML;
              if (i>0)
                     {
                     doppelt(indexZeileVorgabe,indexSpalteVorgabe,i);
                     }
              if(doppelttrue==true)
                     {i=i-1;}
              var ifix=i;
              document.getElementById('tabelle1').rows[zeile].cells[spalte].style.backgroundColor = "#0090E0";

           }

        if (ifix == anzahlZahlen-1) {timeForfind=false;
        timeMove(); }
      }

      function doppelt(z,s,ii){

      var zeile=z;
      var spalte=s;
      var jj=ii;
      doppelttrue=false;

     for (var j=0 ;j<= jj-1;j++)
     {
      if ((zeile[j]==zeile[jj]) && (spalte[j]==spalte[jj])) doppelttrue=true;

     }
      }



      function levelMove()
        {
          var elem = document.getElementById("myLevelBar");

          if (progressValue >= 100)
           {progressValue=0; }

              else
              {
                 progressValue=progressValue+20;
                 width=progressValue;
                 elem.style.width = width + '%';
              }
          }

          function timeMove()
                     {

           // Misst die Zeit.
           // gesteuert wird das über width und die globale Variable timeForFind

            var elem = document.getElementById("myTimeBar");
            var width = 0;
              document.getElementById("suchZahl").innerHTML = " Konzentriere dich, merk dir die blauen Felder" ;
            var id = setInterval(frame, 1000);

           function frame()
           {
             if(timeForFind==true)
                   {
                   clearInterval(id);
                   }
             if (width >= 100)

                    {
                      //width=20;
                      clearInterval(id);
                      StopSofort=true;
                      document.getElementById("suchZahl").innerHTML = " Jetzt such" ;

                      document.getElementById("btnnr1").disabled = true;
                      document.getElementById("btnnr2").disabled = false;
                      timeForFind=false;

                             for (var i = 0;i<=anzahlZeilen-1;i++) {

                             for (var j= 0; j <=anzahlSpalten-1; j++)
                               {


                             document.getElementById('tabelle1').rows[i].cells[j].innerHTML="??";
                             document.getElementById('tabelle1').rows[i].cells[j].style.backgroundColor="#F0F0F0";
                               }

                             }
                      }

                         else
                          {


                            width= width+(100/5);
                            elem.style.width = width + '%';
                            document.getElementById("btnnr2").disabled = true;
                            document.getElementById("btnnr1").disabled = true;

                          }
              }
            }

     function random(max)
          {
            return Math.floor((Math.random() *max)+1);
          }

     function changeCellSize(z,s){

     // Reduziert die Zellgröße wenn die Anzahl der Spalten und Zeilen ansteigt.

      var tds = document.getElementsByTagName('td');

      for (var i = 0; i < tds.length; i++)
          {
          tds[i].style.width =(48*7/s) + 'px';
          tds[i].style.height  =(48*7/z) + 'px';
          }
      }

      function zeigZahl(z,s) {
          // Zeigt die gesuchte Zahl an bei Zeitüberschreitung
          for (var i = 0; i <= anzahlZahlen - 1; i++)

          {
          var zeile=s[i];
          var spalte=z[i];

          document.getElementById('tabelle1').rows[spalte].cells[zeile].style.backgroundColor = "#0090E0";
          }
      }

  function giveNumber(x)
  {
  actualButton=x;
  document.getElementById('btn' +actualButton).style.backgroundColor = "#FF00C0";
  }


</script>
</body>
</html>