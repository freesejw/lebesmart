<!DOCTYPE html>
<html>
<head>
<h1>Arbeitsspeicher &Uuml;bung 4</h1>
<title>Gehirn Aufgabe 4</title>
<style>

#wrapper {
  width:400px;
  height:600px;
  background-color: white;
  padding: 10px;
  border: 1px solid blue;
  margin: 5px;
  position:relative;
  background-color: #FFEFDB;
}


td {
width:50px;
height:50px;
text-align:center;
font-size: 24px;
}

#myLevelProgress {
  position:absolute;
  left:10px;
  top:470px;
  width: 395px;
  height: 24px;
  background-color: #ddd;
  border:1px solid #0090E0;
}

      #myLevelBar { width: 0%; height: 100%;background-color:#0090E0;}
      #levelLabel {text-align: center; line-height: 30px; color: white;}

#myTimeProgress {
  position:absolute;
  left:10px;
  top:510px;
  width: 395px;
  height: 24px;
  background-color: #ddd;
  border:1px solid #0090E0;
  }

        #myTimeBar {width: 0%;height: 100%; background-color: #FF0000;}
        #myTimeLabel { text-align: center;line-height: 30px;color: white;}

#TimeLabel {
    text-align: center; /*  */
    line-height: 30px; /*  */
    color: blue;
    padding-left:220px;
}
#LevelLabel {
    text-align: center;
    line-height: 30px;
    color: blue;
    padding-left:220px;
}
p{
position:absolute;
color: red;
ont-size: 20px;
 font-weight: bold;
 line-height: 1.5em;
 left:10px;
  top:430px;
}
.button1 {
float:left;
 margin-top: 20px;
    background-color: #00AFFF;
    border: 1 solid #0020FF;
    color: white;
    padding: 2px 2px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 18px;
}


</style>
</head>
<body onLoad="window.firstStart(7,7)">


<div id="wrapper">
    <table  id="wrtabelle1"> </table>


    <input type="button" class = "button1" id="btnnr1" value="Start mit Level 1" onclick="secondStart(anzahlZeilen,anzahlSpalten)" />
    <input type="button" class = "button1" id="btnnr2" value="N&auml;chstes Level" onclick="nextLevel()" />



<div id="myLevelProgress">
  <div id="myLevelBar">
    <div id="LevelLabel">Level</div>
    </div>
</div>

<div id="myTimeProgress">
  <div id="myTimeBar">
    <div id="TimeLabel">Zeit</div>
    </div>
</div>

<br>
<p id="suchZahl"></p>
</div>

<script>

    var anzahlZeilen=6;
    var anzahlSpalten=6;
    var anzahlZahlenStart=3;
    var StopSofort=false;
    var progressValue=0;
    var maxValueStart=-1;
    var counter=0;
    var ausgabeArray=[0,0,0,0];
    var ausgabeZahl="";
    var schalter=false;
    var indexZeileVorgabe= [];
    var indexSpalteVorgabe= [];
    var timeForFind= false;
    var anzahlZahlen;
    var doppelttrue=false;

      var img1 =new Image();
      var img2 =new Image();
      var img3 =new Image();

     img1.src="augeRot.gif";
     img2.src="augeLeer.gif";
     img2.src="augeGruen.gif";

        function start(row, col)

          {
            maxValue=maxValueStart;
            node = document.getElementById("wrtabelle1");
            node.appendChild(createTable(row, col, "tabelle1"), node);
          }


        function firstStart(z,s)
       //Startet bei Aufruf des Programms
             {
                 start(anzahlZeilen,anzahlSpalten);
                 document.getElementById("btnnr2").disabled = true;

             }

        function secondStart(z,s)
          //Startet mit dem Button "Start mit Level  1 "
          //

          {
          document.getElementById("btnnr2").disabled = false;
          document.getElementById("btnnr1").disabled = true;

             tabelle1.parentNode.removeChild(tabelle1);
             maxValueStart=9;
             start(anzahlZeilen,anzahlSpalten);
             counter=0;
             StopSofort=false;
             anzahlZahlen=anzahlZahlenStart;
             VorgabeZahlErmitteln(anzahlZeilen,anzahlSpalten);
             document.getElementById("myLevelBar").style.width="0%";

          }




      function nextLevel()
      {
          //Entfernt die bestehende Tabelle und ersetzt
          // sie durch eine neue Tabelle mit neuen Zahlen
               document.getElementById("suchZahl").innerHTML =" ";
               document.getElementById("btnnr2").disabled = false;
               document.getElementById("btnnr1").disabled = true;


                tabelle1.parentNode.removeChild(tabelle1);

                maxValueStart=9;

                start(anzahlZeilen,anzahlSpalten);
                 //changeCellSize(anzahlZeilen,anzahlSpalten);

                counter=0;
                StopSofort=false;
                VorgabeZahlErmitteln(anzahlZeilen,anzahlSpalten);


          }


      function createTable(row, col, id)
      {
          var myTable = document.createElement("table");
          var mytablebody = document.createElement("tbody");

          for (var j = 0; j < row; j++)
          {
              mycurrent_row = document.createElement("tr");
              for (var i = 0; i < col; i++)
               {
                  mycurrent_cell = document.createElement("td");
                  mycurrent_cell.addEventListener("click", function (iii, jjj)
                   {
                    //////////////////////////////////////////////////////////////////////////////////////

                      return function ()
                      {
                           pruef(jjj,iii,counter);

                           if (StopSofort==true)
                                {
                                   myTable.setAttribute("data-locked", "true");
                                    progressValue=0;
                                    document.getElementById('tabelle1').rows[jjj].cells[iii].childNodes[0].src = "augeRot.gif";
                                    document.getElementById("suchZahl").innerHTML ="Falsches Feld. Beginn wieder mit Start";

                                    document.getElementById("btnnr2").disabled = true;
                                    document.getElementById("btnnr1").disabled = false;
                                }


                          if (!myTable.getAttribute("data-locked"))

                             { document.getElementById('tabelle1').rows[jjj].cells[iii].childNodes[0].src = "augeGruen.gif";

                                if (anzahlZahlen<= counter)
                                 {
                                    myTable.setAttribute("data-locked", "true");
                                    document.getElementById("suchZahl").innerHTML ="Level geschafft, auf zum nächsten Level";
                                    levelMove();
                                     anzahlZahlen = anzahlZahlen +1;

                                     document.getElementById("btnnr2").disabled = false;
                                     document.getElementById("btnnr1").disabled = true;
                                 }

                                 if (progressValue >= 100)

                                   {
                                    document.getElementById("suchZahl").innerHTML =" Glückwunsch, alle Level erfolgreich geschafft!" ;
                                    document.getElementById("suchZahl").style.color = "blue";
                                    document.getElementById("suchZahl").style.fontSize = "large";
                                    document.getElementById("btnnr2").disabled = true;
                                    document.getElementById("btnnr1").disabled = false;
                                   }
                            }
                          }
                       ////////////////////////////////////////////////////////////////////////////////////////////////
                    }
                  (i, j));

                  currentimage = document.createElement("IMG");
                  currentimage.setAttribute("src", "augeLeer.gif");
                  mycurrent_cell.appendChild(currentimage);
                  mycurrent_row.appendChild(mycurrent_cell);
              }

              mytablebody.appendChild(mycurrent_row);
          }

          myTable.appendChild(mytablebody);
          myTable.setAttribute("ID", id);
          return myTable;
      }





     function pruef(z,s,c){

       // z Zeilenposition der geclickten Zahl
       // s Spaltenposition der geclickten Zahl
       // Anzahl der Clicks insgesamt(Länge der Zahl)
       // greift auf das Array vorgabe aus der Funktion VorgabeZahlErmitteln zu
       // in dem ARRay vorgabe befinden sich die Länge der Zahl,der Zeilenindex und die Spaltenindizes.

        schalter=false;

        var zeileAusClick = z;
        var spalteAusClick = s;

        for (var i = 0;i<=anzahlZahlen -1 ;i++)
            {

             if ((indexZeileVorgabe[i]==zeileAusClick) && (indexSpalteVorgabe[i]==spalteAusClick))
                  {
                       schalter = true;
                        StopSofort=false;
                  }
             }

            if (schalter==false)
               {
               StopSofort=true;
               }

          if (StopSofort==false)
          {counter++;}
          return StopSofort;

        }


     function VorgabeZahlErmitteln(z,s){

     // Diese Funktion ermittelt die Zahl die vorgegeben wird und die wieder durch clicken bestätigt werden muss
     //
     // in dem Array vorgabe befinden sich die Länge der Zahl,der Zeilenindex und die Spaltenindizes.
     // Dieses Array wird an die Funktion pruef übergeben.
     // s:  Anzahl spalten
     // z : Anzahl der Zeilen

          for (var i = 0; i <= anzahlZahlen-1; i++)

          {
              indexZeileVorgabe[i]=random(z-1);;
              indexSpalteVorgabe[i]=random(s-1);
              var zeile= indexZeileVorgabe[i]
              var spalte= indexSpalteVorgabe[i];
              if (i>0)
                     {
                     doppelt(indexZeileVorgabe,indexSpalteVorgabe,i);
                     }
              if(doppelttrue==true)
                     {i=i-1;}
              var ifix=i;
             //document.getElementById('tabelle1').rows[zeile].cells[spalte].style.backgroundColor = "#0090E0";
              document.getElementById('tabelle1').rows[zeile].cells[spalte].childNodes[0].src = "augeRot.gif";
           }

        if (ifix == anzahlZahlen-1) {timeForfind=false;
        timeMove(); }


      }

      function doppelt(z,s,ii){

      var zeile=z;
      var spalte=s;
      var jj=ii;
      doppelttrue=false;

     for (var j=0 ;j<= jj-1;j++)
     {


      if ((zeile[j]==zeile[jj]) && (spalte[j]==spalte[jj])) doppelttrue=true;

     }
      }



      function levelMove()
        {
          var elem = document.getElementById("myLevelBar");

          if (progressValue >= 100)
           {progressValue=0; }

              else
              {
                 progressValue=progressValue+20;
                 width=progressValue;
                 elem.style.width = width + '%';
              }
          }

          function timeMove()
                     {

           // Misst die Zeit.
           // gesteuert wird das über width und die globale Variable timeForFind

            var elem = document.getElementById("myTimeBar");
            var width = 0;
              document.getElementById("suchZahl").innerHTML = " Konzentriere dich " ;
            var id = setInterval(frame, 1000);

           function frame()
           {
             if(timeForFind==true)
                   {
                   clearInterval(id);
                   }
             if (width >= 100)

                    {
                      //width=20;
                      clearInterval(id);
                      StopSofort=true;

                             for (var i = 0;i<=anzahlZeilen-1;i++) {

                             for (var j= 0; j <=anzahlSpalten-1; j++)
                               {

                               document.getElementById('tabelle1').rows[i].cells[j].childNodes[0].src = "augeLeer.gif";

                               }

                             }
                      document.getElementById("suchZahl").innerHTML = " Jetzt such" ;

                      document.getElementById("btnnr1").disabled = true;
                      document.getElementById("btnnr2").disabled = false;
                      timeForFind=false;

                      }

                         else
                          {


                            width= width+(100/5);
                            elem.style.width = width + '%';
                            document.getElementById("btnnr2").disabled = true;
                            document.getElementById("btnnr1").disabled = true;

                          }
              }
            }

     function random(max)
          {
            return Math.floor((Math.random() *max)+1);
          }

     function changeCellSize(z,s){

     // Reduziert die Zellgröße wenn die Anzahl der Spalten und Zeilen ansteigt.

      var tds = document.getElementsByTagName('td');

      for (var i = 0; i < tds.length; i++)
          {
          tds[i].style.width =(48*7/s) + 'px';
          tds[i].style.height  =(48*7/z) + 'px';
          }
      }

      function zeigZahl(z,s) {
          // Zeigt die gesuchte Zahl an bei Zeitüberschreitung
          for (var i = 0; i <= anzahlZahlen - 1; i++)

          {
          var zeile=s[i];
          var spalte=z[i];

          document.getElementById('tabelle1').rows[spalte].cells[zeile].style.backgroundColor = "#0090E0";
          }
      }
    function checkMe(x){
    var checkZahl=x;
     alert(checkZahl);
     }

</script>
</body>
</html>