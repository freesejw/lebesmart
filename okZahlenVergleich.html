<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">        
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<style>

Canvas {
   position: absolute;
   top: 0px;
   left: 0px;
   background-color: #F6F6F6;
}
</style>
</head>
<body onload="ladeGame()">
    <canvas id="canvas" width="500" height="600"></canvas>
     
<script>
var canv = document.getElementById("canvas");
var ctx = canv.getContext("2d");

var audi0;
var myVar;
var reaktionsZeit=1.0,maxDurchlaeufe=10;
var durchLaeufe, treffer;
var z1, z2;
var offenButton; 
var xBasis=20, yBasis1=280, wBasis1=60, hBasis=40, dBasis=40, xtextdis=20, ytextdis=25;
var yBasis2= 460, wBasis2=120, yErhoehung=50;


var rects = [{x: xBasis, y: yBasis2 + yErhoehung, w: wBasis2, h: hBasis,col1: "#82CE86",col2:"#82CE86"},
             {x: (xBasis + wBasis2+ dBasis), y: yBasis2 + yErhoehung, w: wBasis2, h: hBasis,col1: "#ea2867",col2: "#ea2867"},
             {x: (xBasis + 2 *( wBasis2+ dBasis)), y: yBasis2, w: wBasis2, h: hBasis,col1: "#5a617b",col2: "#5a617b"},             
             {x: (xBasis + 2 * (wBasis2+ dBasis)), y: yBasis2 + yErhoehung, w: wBasis2, h: hBasis,col1: "#5a617b",col2: "#5a617b"},             

             {x: xBasis, y: 120 , w: wBasis2, h: 3* hBasis,col: "#F2F2F2" },
             {x: 280, y: 120 , w: wBasis2, h: 3*hBasis,col: "#F2F2F2"}];


var texts =[{na:"   "+  String.fromCharCode(9655)+ "  Go on", x: xBasis + xtextdis -10, y: yBasis2 + ytextdis+yErhoehung,},
           {na: "  " + String.fromCharCode(9673)+"  Ende", x: (xBasis + xtextdis +  wBasis2 + dBasis),y: yBasis2 + ytextdis + yErhoehung} ,
           {na: "    " + String.fromCharCode(43)+"  Zeit", x: (xBasis + 15+ 2 * (wBasis2+ dBasis)),y: yBasis2 + ytextdis },
           {na: "    " + String.fromCharCode(45)+"  Zeit", x: (xBasis + 15 + 2 * (wBasis2+ dBasis)),y: yBasis2 + yErhoehung + ytextdis },

           {na: "Links !!", x: (xBasis + xtextdis ),y: yBasis1  + ytextdis/2 },
           {na: "Rechts !!", x: (280 + xtextdis ),y: yBasis1 +  ytextdis/2 }];


function ladeGame()
    {
       // boxMeldung(("?"),xBasis,120,100,100,25);
       // boxMeldung(("?"),280,120,100,100,25);
        meldung("Verbessere deine Reaktionszeit und Konzentration","bold","20","Arial","#5a617b",10, 35);  
        meldung("Ist die Zahl links oder rechts höher? Klick sie an !","normal","16","Arial","#5a617b",xBasis, 100); 
        meldung("Es gibt 10 Durchgänge","normal","16"," Arial","#5a617b",xBasis ,320); 
        meldung("Zeit zum Reagieren = " +  reaktionsZeit + " Sek","normal","16,"," Arial","#5a617b",xBasis ,360); 
        meldung(( "Anzahl Treffer :  0"),"bold","16","Arial","#5a617b",xBasis, 400);   
        roundedButton()
        buttonText();
        ctx.strokeRect(rects[4].x, rects[4].y, rects[4].w, rects[4].h);
        ctx.strokeRect(rects[5].x, rects[5].y, rects[5].w, rects[5].h);  
        ctx.fillStyle="#F2F2F2";
        ctx.fillRect(rects[4].x, rects[4].y, rects[4].w, rects[4].h);
        ctx.fillRect(rects[5].x, rects[5].y, rects[5].w, rects[5].h);
        offenButton=true;
    };


function start()
    {
        ctx.clearRect(xBasis, 440, 300, -20);   // Löschen Trefferquote
        ctx.clearRect(xBasis,400,200,-20);  // Löschen Anzahl Treffer
        treffer=0;
        meldung(( "Anzahl Treffer :  " + treffer),"bold" ,"16","Arial","#5a617b",xBasis, 400);  
       // ctx.strokeRect(rects[4].x, rects[4].y, rects[4].w, rects[4].h);
       // ctx.strokeRect(rects[5].x, rects[5].y, rects[5].w, rects[5].h);        
        durchLaeufe=0;
        myVar = setInterval(iteration, reaktionsZeit*1000); 
        offenButton=false;
        
    }

function iteration()
{
        durchLaeufe++;  
        ctx.fillStyle="#F2F2F2";
        ctx.fillRect(rects[4].x, rects[4].y, rects[4].w, rects[4].h);
        ctx.fillRect(rects[5].x, rects[5].y, rects[5].w, rects[5].h);    
        if (durchLaeufe <= maxDurchlaeufe)
        {           
            z1=getRnd(1,10); 
            var schriftGroesse1=getRnd(15,90);
                
            meldung(z1.valueOf() ,"bold",schriftGroesse1,"Arial","#5a617b",xBasis + rects[4].w*.3,120+rects[4].h*0.7);
       
            do {
                
                z2=getRnd(1,10);
                schriftGroesse2=getRnd(15,90);
                //console.log(" nr 1 " + schriftGroesse1 + " nr 2   " + schriftGroesse2 + " hallo  " + (Math.abs( schriftGroesse1  - schriftGroesse2))) ;
                }
                while ((Math.abs(schriftGroesse1-schriftGroesse2 ) < 25) || (z1 == z2));

            meldung(z2.valueOf() ,"bold",schriftGroesse2,"Arial","#5a617b",280 + rects[5].w*.3,120+rects[5].h*0.7);
            //console.log("Zufallstahl #1: " + z1 + " | Zufallszahl #2: " + z2 + " | Differenz: " + (z1-z2) + " | Schriftgrößenunterschied: " + (Math.abs( schriftGroesse1  - schriftGroesse2)))
         }

        else
            {                    
            clearInterval(myVar);
            abbruch();


            }
}

function abbruch()

    {
        offenButton=true;
        var quote=(treffer)/(durchLaeufe-1);
        quote=Math.round(quote*100);
        ctx.clearRect(xBasis, 440, 300, -16);               
        meldung("Deine Trefferquote war " + quote + " Prozent","bold","16","Arial","red",xBasis,440);  
        clearInterval(myVar);   
      
        ctx.fillStyle="#F2F2F2";
        ctx.fillRect(rects[4].x, rects[4].y, rects[4].w, rects[4].h);
        ctx.fillRect(rects[5].x, rects[5].y, rects[5].w, rects[5].h);
    }


 canv.addEventListener('click', function(e)
     {       
        var rect = angetippt(rects, e.offsetX, e.offsetY);
        if (rect) 
        {
            auswahlButton(); 
                   
        }}, false);


function angetippt(rects, x, y) {
    var zw;
    var isCollision = false;
    for (let i = 0, len = rects.length; i < len; i++) {
            var left = rects[i].x, right = rects[i].x+rects[i].w;
            var top = rects[i].y, bottom = rects[i].y+rects[i].h;
            if (right >= x
                && left <= x
                && bottom >= y
                && top <= y) {
                    isCollision = rects[i];   
                    getipptRechteck=i;          
                }
    }
    return isCollision;
}

function auswahlButton()
    {
        switch (getipptRechteck) 
                {
                    case 0:                                         
                        start();
                        break;
                    case 1:
                        abbruch();                        
                        break;
                    case 2:
                    if (offenButton==true)
                    {
                    reaktionsZeit=plusMinus(reaktionsZeit,0.25,1,15);
                    meldung("Zeit zum Reagieren = " +  reaktionsZeit.toFixed(2) + " Sek","normal","16"," Arial","#5a617b",xBasis ,360);                      
                    }                                       
                    break;
                    case 3:
                    if (offenButton==true)
                    {
                    reaktionsZeit=plusMinus(reaktionsZeit,-0.25,0,15);
                    meldung("Zeit zum Reagieren = " +  reaktionsZeit.toFixed(2) + " Sek","normal","16"," Arial","#5a617b",xBasis ,360); 
                    }                     
                        break;
                     case 4:
                     //links getippt
                        vergleich(4);                        
                        break;  
                     case 5:
                     //rechts getippt
                        vergleich(5);                        
                        break;                 
                    default:
                       alert("ups");
                }             
    }

function vergleich(a)
{
    
       
            if((a==4 && z1>z2) ||(a==5 && z1<z2))
            {
                treffer++;   
                ctx.clearRect(xBasis,400,200,-20);     
                meldung(( "Anzahl Treffer :  " + treffer),"bold","16","Arial","#5a617b",xBasis, 400);  
                
            }    
    else{akustischeMeldung("audio/up.mp3");   }
    
}

function roundedButton()
{
       for (var i = 0, len = rects.length; i < len-2; i++) {       
       ctx.fillStyle=rects[i].col1;
       roundedRect(rects[i].x, rects[i].y, rects[i].w, rects[i].h,10);
      // ctx.fillStyle=rects[i].col2 , 
       //roundedRect(rects[i].x+5, rects[i].y+5, rects[i].w-10, rects[i].h-10,10);       
      }
}

function buttonText(a)
{ 
      
    ctx.fillStyle = "white";
    ctx.font = "18px Comfortaa";
    for (var i = 0;i < 4; i++) 
    {
       
       ctx.fillText(texts[i].na,texts[i].x, texts[i].y);
      
     }
}





 function getRnd(min, max) 
  {
  return Math.floor(Math.random() * (max - min)) + min;
 } 

 meldung(( "Anzahl Treffer :  0"),"bold","16","Arial","#5a617b",xBasis, 400);  

function meldung(text,schriftDicke,schriftGroesse,schriftTyp,farbe,xm,ym)
   {
      
       var lg = 10 + ctx.measureText(text).width 
       ctx.clearRect(xm, ym-schriftGroesse+2,lg,25);
        ctx.fillStyle = farbe;        
        ctx.font =schriftDicke + ' ' + (schriftGroesse + "px "+ schriftTyp);            
        ctx.fillText(text, xm ,ym); 
    }

 

function plusMinus(ausgang,delta,unten,oben)
{
 // Mehr oder weniger Zeit zum Suchen
  let anz=ausgang; 
  if ((anz + delta)< oben && delta>0)
  {anz=anz + delta; }
  if ((anz + delta)> unten && delta<=0)
  {anz=anz + delta; }
  
  return anz;
}

function akustischeMeldung(a)
    {
        audio = new Audio(a);
        audio.play();
    }

    function roundedRect(x, y, width, height, radius) {
  ctx.beginPath();
  ctx.moveTo(x, y + radius);
  ctx.lineTo(x, y + height - radius);
  ctx.arcTo(x, y + height, x + radius, y + height, radius);
  ctx.lineTo(x + width - radius, y + height);
  ctx.arcTo(x + width, y + height, x + width, y + height-radius, radius);
  ctx.lineTo(x + width, y + radius);
  ctx.arcTo(x + width, y, x + width - radius, y, radius);
  ctx.lineTo(x + radius, y);
  ctx.arcTo(x, y, x, y + radius, radius);
  ctx.lineWidth = 1;
  ctx.stroke(); 
  ctx.fill();
}    
</script>


       
<p>Enjoy !</p>

</body>
</html>
